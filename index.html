<!doctype html>

<html>
  <head>
    <title>Eth Sign Tests</title>
      <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/gh/ethereumjs/browser-builds/dist/ethereumjs-tx/ethereumjs-tx-1.3.3.min.js"></script>


  <link rel="stylesheet" type="text/css" href="css/style.css">

  </head>

  <body>
    <div class="jumbotron jumbotron-fluid">
      <div class="container">
        <h1 class="display-4">JS Ethereum Signature Example</h1>
        <p class="lead">Simple signature examples for use with <a href="https://www.metamask.io"> MetaMask </a></p>
      </div>
    </div>
    <div class="container">
      <div class="row border-bottom hidden" >
          <div class="col-6">
            <h3>Connect</h3>
          </div>
            <div class="col-6">
              <button type="button" class="btn btn-dark" id="connectButton">Connect</button>
            </div>
        </div>
      <div class="row border-bottom hidden" >
        <div class="col-6">
          <h3>Eth_Sign</h3>
        </div>
        <div class="col-6">
          <button type="button" class="btn btn-dark" id="ethSignButton">eth_sign</button>
        </div>
      </div>
      <div class="row border-bottom hidden" >
        <div class="col-6">
          <h3>personal_sign</h3>
        </div>
        <div class="col-6">
          <button type="button" class="btn btn-dark" id="personalSignButton">personal_sign</button>
        </div>
      </div>
      <div class="row border-bottom hidden" >
        <div class="col-6">
          <h3>personal_ecRecover</h3>
        </div>
        <div class="col-6">
          <button type="button" class="btn btn-dark" id="personalRecoverTest">personal_ecRecover</button>
        </div>
      </div>
      <div class="row border-bottom hidden" >
        <div class="col-6">
          <h3>Ethjs Personal Sign</h3>
        </div>
        <div class="col-6">
          <button type="button" class="btn btn-dark" id="ethjsPersonalSignButton">ethjs personal sign</button>
        </div>
      </div>
      <div class="row border-bottom" >
        <div class="col-6">
            <input type="text" class="form-control" id="hotWallet" placeholder="Горячий кошелек">
        </div>
        <div class="col-6">
            <input type="text" class="form-control" id="sum" placeholder="Сумма">
        </div>
        <div class="col-6">
            <input type="text" class="form-control" id="to" placeholder="Куда">
        </div>
        <div class="col-6">
            <input type="text" class="form-control" id="password" placeholder="Пароль">
        </div>
        <div class="col-6">
          <button type="button" class="btn btn-dark" id="signTypedDataButton">Получить подпись</button>
        </div>
      </div>

      <div class="row">
        <p id="sign"></p>
      </div>

      <div class="row border-bottom" >
        <div class="col-6">
            <input type="text" class="form-control" id="hotWalletForKeyW" placeholder="Горячий кошелек">
        </div>
        <div class="col-6">
          <button type="button" class="btn btn-dark" id="signTypedDataButtonKey">Получить подпись для создания ключа</button>
        </div>
      </div>

      <div class="row">
        <p id="keySign"></p>
      </div>

      <div class="row border-bottom" >
        <div class="col-6">
            <input type="text" class="form-control" id="hotWalletForReservedW" placeholder="Горячий кошелек">
        </div>
        <div class="col-6">
          <button type="button" class="btn btn-dark" id="signTypedDataButtonRes">Получить подпись для создания резервного</button>
        </div>
      </div>

      <div class="row">
        <p id="reservedSign"></p>
      </div>

      
      <div class="row border-bottom hidden" >
          <div class="col-6">
            <h3>Sign Typed Data V3</h3>
          </div>
          <div class="col-6">
            <button type="button" class="btn btn-dark" id="signTypedDataV3Button">sign typed data v3</button>
          </div>
        </div>
      <div class="row border-bottom hidden" >
        <div class="col-6">
          <h3>Sign Typed Data with Ethjs</h3>
        </div>
        <div class="col-6">
          <button type="button" class="btn btn-dark" id="ethjsSignTypedDataButton">sign typed data with ethjs</button>
        </div>
      </div>

    </div>

    <div class="container">
      <script>
        const EthUtil = require('ethereumjs-util')
const EthTx = require('ethereumjs-tx')
// signed tx
const signedTx = "0xf86b808504a817c800825208942890228d4478e2c3b0ebf5a38479e3396c1d6074872386f26fc100008029a0520e5053c1b573d747f823a0b23d52e5a619298f46cd781d677d0e5e78fbc750a075be461137c2c2a5594beff76ecb11a215384c574a7e5b620dba5cc63b0a0f13"
// Create a tx object from signed tx 
const tx = new EthTx(signedTx)
// Get an address of sender
const address = EthUtil.bufferToHex(tx.getSenderAddress())
// get a public key of sender
const publicKey = EthUtil.bufferToHex(tx.getSenderPublicKey())
console.log(address)
// => 0x89c24a88bad4abe0a4f5b2eb5a86db1fb323832c
console.log(publicKey)
// => 0xfff49b58b83104ff16875452852466a46c7169ba4e368d11830c9170624e0a9509080a05a38c18841718ea4fc13483ac467d3e2d728d41ff16b73b9c943734f8
  </script>
    </div>

    <div class="container">
      <div class="row">
        <a href="https://github.com/danfinlay/js-eth-personal-sign-examples">View the source code on Github</a>
      </div>
    </div>

  </body>

  <script src="bundle.js"></script>
  <!--<script src="https://raw.githubusercontent.com/ethereumjs/browser-builds/master/dist/ethereumjs-tx/ethereumjs-tx-1.3.3.js"></script>-->
</html>